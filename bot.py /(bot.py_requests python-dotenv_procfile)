import telebot
from telebot.types import InlineKeyboardMarkup, InlineKeyboardButton

# Ø§Ù„ØªÙˆÙƒÙ† Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ø¨ÙˆØª
BOT_TOKEN = "7891692862:AAGKGmIJubgxLkKELRMSdxpMXgm-QBooqM0"
bot = telebot.TeleBot(BOT_TOKEN)

# Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù‚Ù†ÙˆØ§Øª
CHANNELS = [
    {"name": "Ø§Ù„Ù‚Ù†Ø§Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰", "url": "https://t.me/+VxJLVxgndBo0Zjk0"},
    {"name": "Ø§Ù„Ù‚Ù†Ø§Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©", "url": "https://t.me/+HqqRgjQZYjpmMDVk"},
    {"name": "Ø§Ù„Ù‚Ù†Ø§Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø©", "url": "https://t.me/+LFhCUR0ASBtmZmE8"}
]

# Ø±Ø§Ø¨Ø· Ø¨ÙˆØª Ø§Ù„Ø£Ø±Ù‚Ø§Ù…
NUMBERS_BOT_LINK = "https://t.me/ALBERUBOT?start=Y9SF1G3A"

# Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªØ±Ø­ÙŠØ¨ÙŠØ© Ø¨Ø§Ù„Ù„ØºØªÙŠÙ†
MESSAGES = {
    "ar": """
âœ§ï½¥ï¾Ÿ: *âœ§ï½¥ï¾Ÿ:* âœ¨âœ¨  
ğŸ‰ *Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø¨ÙˆØª Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø®Ø§Øµ Ø¨Ù†Ø§!* ğŸ‰  
âœ¨âœ¨ *:ï½¥ï¾Ÿâœ§*:ï½¥ï¾Ÿâœ§ âœ¨âœ¨  

âš ï¸ *Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ø¨ÙˆØªØŒ ÙŠÙØ±Ø¬Ù‰ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙÙŠ Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ø£ÙˆÙ„Ø§Ù‹.*  
ğŸ“Œ Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ø´ØªØ±Ø§ÙƒØŒ Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± "ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ" Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©.  
ğŸ¯ *Ù†Ø­Ù† Ù‡Ù†Ø§ Ù„Ø®Ø¯Ù…ØªÙƒ Ø¯Ø§Ø¦Ù…Ù‹Ø§!*  
    """,
    "en": """
âœ§ï½¥ï¾Ÿ: *âœ§ï½¥ï¾Ÿ:* âœ¨âœ¨  
ğŸ‰ *Welcome to our service bot!* ğŸ‰  
âœ¨âœ¨ *:ï½¥ï¾Ÿâœ§*:ï½¥ï¾Ÿâœ§ âœ¨âœ¨  

âš ï¸ *To use this bot, please subscribe to the required channels first.*  
ğŸ“Œ After subscribing, click the "Verify Subscription" button to proceed.  
ğŸ¯ *We're always here to serve you!*  
    """
}

# Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ
def check_subscription(user_id):
    for channel in CHANNELS:
        try:
            status = bot.get_chat_member(chat_id=channel["url"], user_id=user_id)
            if status.status not in ['member', 'administrator', 'creator']:
                return False
        except Exception:
            return False
    return True

# Ù†Ù‚Ø·Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
@bot.message_handler(commands=['start'])
def send_welcome(message):
    user_id = message.from_user.id
    user_lang = message.from_user.language_code  # ØªØ­Ø¯ÙŠØ¯ Ù„ØºØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    lang = "en" if user_lang == "en" else "ar"

    # ØªØ¬Ù‡ÙŠØ² Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ÙŠØ©
    welcome_message = MESSAGES[lang]

    # Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
    markup = InlineKeyboardMarkup()
    for channel in CHANNELS:
        markup.add(InlineKeyboardButton(f"ğŸ“¢ {channel['name']}", url=channel["url"]))

    markup.add(InlineKeyboardButton("âœ… ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ", callback_data="check_subscription"))
    bot.send_message(chat_id=message.chat.id, text=welcome_message, reply_markup=markup, parse_mode="Markdown")

# Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø±
@bot.callback_query_handler(func=lambda call: call.data == "check_subscription")
def callback_check_subscription(call):
    user_id = call.from_user.id
    if check_subscription(user_id):
        bot.answer_callback_query(callback_query_id=call.id, text="âœ… ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ Ø¨Ù†Ø¬Ø§Ø­!" if call.from_user.language_code != "en" else "âœ… Verified successfully!")
        bot.send_message(chat_id=call.message.chat.id, text="ğŸ‰ Ø´ÙƒØ±Ø§Ù‹ Ù„Ø§Ø´ØªØ±Ø§ÙƒÙƒ! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø§Ù„Ø°Ù‡Ø§Ø¨ Ø¥Ù„Ù‰ Ø¨ÙˆØª Ø§Ù„Ø£Ø±Ù‚Ø§Ù…." if call.from_user.language_code != "en" else "ğŸ‰ Thank you for subscribing! You can now access the numbers bot.")
        
        # Ø²Ø± Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø¨ÙˆØª Ø§Ù„Ø£Ø±Ù‚Ø§Ù…
        markup = InlineKeyboardMarkup()
        markup.add(InlineKeyboardButton("ğŸ”¢ Ø§Ù„Ø°Ù‡Ø§Ø¨ Ø¥Ù„Ù‰ Ø¨ÙˆØª Ø§Ù„Ø£Ø±Ù‚Ø§Ù…", url=NUMBERS_BOT_LINK))
        bot.send_message(chat_id=call.message.chat.id, text="ğŸ‘‡ Ø§Ø¶ØºØ· Ø§Ù„Ø²Ø± Ø£Ø¯Ù†Ø§Ù‡ ğŸ‘‡" if call.from_user.language_code != "en" else "ğŸ‘‡ Click the button below ğŸ‘‡", reply_markup=markup)
    else:
        bot.answer_callback_query(callback_query_id=call.id, text="âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø¨Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚Ù†ÙˆØ§Øª." if call.from_user.language_code != "en" else "âŒ Not all channels subscribed.")
        bot.send_message(chat_id=call.message.chat.id, text="âš ï¸ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ø«Ù… Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± *ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ*." if call.from_user.language_code != "en" else "âš ï¸ Please subscribe to all required channels and click the *Verify Subscription* button.")

# ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª
bot.polling()

pyTelegramBotAPI
requests
python-dotenv

worker: python3 bot.py
